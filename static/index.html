<!DOCTYPE html>
<html lang="ru">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Somon.tj - –ü–æ–¥–∞—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ</title>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- React -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

  <!-- Babel –¥–ª—è JSX -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'somon-blue': '#2563eb',
            'somon-orange': '#ea580c',
            'somon-green': '#16a34a'
          }
        }
      }
    }
  </script>

  <style>
    .mobile-container {
      max-width: 480px;
      margin: 0 auto;
    }

    @media (min-width: 768px) {
      .mobile-container {
        max-width: 768px;
      }
    }

    @media (min-width: 1024px) {
      .mobile-container {
        max-width: 1024px;
      }
    }

    .drag-active {
      border-color: #ea580c !important;
      background-color: #fed7aa !important;
    }

    .spinner {
      border: 2px solid #f3f3f3;
      border-top: 2px solid #ea580c;
      border-radius: 50%;
      width: 16px;
      height: 16px;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% {
        transform: rotate(0deg);
      }

      100% {
        transform: rotate(360deg);
      }
    }

    .product-card {
      transition: all 0.2s ease;
    }

    .product-card:hover {
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }
  </style>
</head>

<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useRef, useEffect } = React;

    const PhotoListingApp = () => {
      const [currentStep, setCurrentStep] = useState('upload'); // 'upload', 'results', 'promotion'
      const [uploadedImages, setUploadedImages] = useState([]);
      const [processing, setProcessing] = useState(false);
      const [dragActive, setDragActive] = useState(false);
      const [results, setResults] = useState([]);
      const [publishedItems, setPublishedItems] = useState([]);
      const [userDescription, setUserDescription] = useState('');
      const fileInputRef = useRef(null);

      // –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã —Å —Å–µ—Ä–≤–µ—Ä–∞
      const [categories, setCategories] = useState({});
      const [categoriesLoaded, setCategoriesLoaded] = useState(false);

      const conditions = ['–ù–æ–≤–æ–µ', '–û—Ç–ª–∏—á–Ω–æ–µ', '–•–æ—Ä–æ—à–µ–µ', '–£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ–µ', '–ù–∞ –∑–∞–ø—á–∞—Å—Ç–∏'];
      const currencies = ['—Å–æ–º–æ–Ω–∏', '–¥–æ–ª–ª–∞—Ä', '–µ–≤—Ä–æ'];

      // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Å —Å–µ—Ä–≤–µ—Ä–∞
      const loadCategories = async () => {
        try {
          const response = await fetch('/api/categories');
          const data = await response.json();

          if (data.success) {
            setCategories(data.categories);
            setCategoriesLoaded(true);
            console.log('–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã:', data.categories);
          } else {
            console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π:', data.error);
            // Fallback –∫ –±–∞–∑–æ–≤—ã–º –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
            setCategories({
              '–û–¥–µ–∂–¥–∞ –∏ –ª–∏—á–Ω—ã–µ –≤–µ—â–∏': ['–ú—É–∂—Å–∫–∞—è –æ–¥–µ–∂–¥–∞', '–ñ–µ–Ω—Å–∫–∞—è –æ–¥–µ–∂–¥–∞', '–û–±—É–≤—å'],
              '–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞ –∏ –±—ã—Ç–æ–≤–∞—è —Ç–µ—Ö–Ω–∏–∫–∞': ['–¢–µ–ª–µ—Ñ–æ–Ω—ã –∏ —Å–≤—è–∑—å', '–ö–æ–º–ø—å—é—Ç–µ—Ä—ã –∏ –æ—Ä–≥—Ç–µ—Ö–Ω–∏–∫–∞'],
              '–î–µ—Ç—Å–∫–∏–π –º–∏—Ä': ['–î–µ—Ç—Å–∫–∞—è –æ–¥–µ–∂–¥–∞', '–ò–≥—Ä—É—à–∫–∏'],
              '–í—Å–µ –¥–ª—è –¥–æ–º–∞': ['–ú–µ–±–µ–ª—å', '–ë—ã—Ç–æ–≤–∞—è —Ç–µ—Ö–Ω–∏–∫–∞']
            });
            setCategoriesLoaded(true);
          }
        } catch (error) {
          console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π:', error);
          // Fallback –∫ –±–∞–∑–æ–≤—ã–º –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
          setCategories({
            '–û–¥–µ–∂–¥–∞ –∏ –ª–∏—á–Ω—ã–µ –≤–µ—â–∏': ['–ú—É–∂—Å–∫–∞—è –æ–¥–µ–∂–¥–∞', '–ñ–µ–Ω—Å–∫–∞—è –æ–¥–µ–∂–¥–∞', '–û–±—É–≤—å'],
            '–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞ –∏ –±—ã—Ç–æ–≤–∞—è —Ç–µ—Ö–Ω–∏–∫–∞': ['–¢–µ–ª–µ—Ñ–æ–Ω—ã –∏ —Å–≤—è–∑—å', '–ö–æ–º–ø—å—é—Ç–µ—Ä—ã –∏ –æ—Ä–≥—Ç–µ—Ö–Ω–∏–∫–∞'],
            '–î–µ—Ç—Å–∫–∏–π –º–∏—Ä': ['–î–µ—Ç—Å–∫–∞—è –æ–¥–µ–∂–¥–∞', '–ò–≥—Ä—É—à–∫–∏'],
            '–í—Å–µ –¥–ª—è –¥–æ–º–∞': ['–ú–µ–±–µ–ª—å', '–ë—ã—Ç–æ–≤–∞—è —Ç–µ—Ö–Ω–∏–∫–∞']
          });
          setCategoriesLoaded(true);
        }
      };

      // –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
      useEffect(() => {
        loadCategories();
      }, []);

      const handleDrag = (e) => {
        e.preventDefault();
        e.stopPropagation();
        if (e.type === "dragenter" || e.type === "dragover") {
          setDragActive(true);
        } else if (e.type === "dragleave") {
          setDragActive(false);
        }
      };

      const handleDrop = (e) => {
        e.preventDefault();
        e.stopPropagation();
        setDragActive(false);

        const files = Array.from(e.dataTransfer.files);
        handleFiles(files);
      };

      const handleFileSelect = (e) => {
        const files = Array.from(e.target.files);
        handleFiles(files);
      };

      const handleFiles = (files) => {
        const imageFiles = files.filter(file => file.type.startsWith('image/'));

        imageFiles.forEach(file => {
          const reader = new FileReader();
          reader.onload = (e) => {
            setUploadedImages(prev => [...prev, {
              id: Date.now() + Math.random(),
              file,
              preview: e.target.result,
              name: file.name,
              size: file.size
            }]);
          };
          reader.readAsDataURL(file);
        });
      };

      const removeImage = (id) => {
        setUploadedImages(prev => prev.filter(img => img.id !== id));
      };

      const processImages = async () => {
        if (uploadedImages.length === 0) {
          alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –¥–æ–±–∞–≤—å—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞');
          return;
        }

        setProcessing(true);

        try {
          const formData = new FormData();
          uploadedImages.forEach(img => {
            formData.append('files', img.file);
          });

          const response = await fetch('/api/analyze-multiple', {
            method: 'POST',
            body: formData
          });

          if (!response.ok) {
            const errorData = await response.json();
            throw new Error(errorData.error || `HTTP error! status: ${response.status}`);
          }

          const data = await response.json();

          if (data.success) {
            const processedResults = data.results.map(result => {
              const mainCategory = detectCategory(result.description);
              return {
                id: result.id,
                images: [result.image_preview],
                title: extractTitle(result.description),
                description: result.description,
                mainCategory: mainCategory,
                subCategory: detectSubCategory(result.description, mainCategory),
                price: extractPrice(result.description),
                currency: '—Å–æ–º–æ–Ω–∏',
                brand: extractBrand(result.description),
                condition: extractCondition(result.description),
                location: '–î—É—à–∞–Ω–±–µ',
                userInput: userDescription,
                filename: result.filename,
                width: result.width,
                height: result.height,
                size_bytes: result.size_bytes
              };
            });

            setResults(processedResults);
            setCurrentStep('results');
          } else {
            throw new Error(data.error || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞');
          }

        } catch (error) {
          console.error('–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏:', error);
          alert(`–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: ${error.message}`);
        } finally {
          setProcessing(false);
        }
      };

      // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ –æ–ø–∏—Å–∞–Ω–∏—è
      const extractTitle = (description) => {
        const lines = description.split('\n').filter(line => line.trim());
        for (let line of lines) {
          if (line.includes('–¢–û–í–ê–† –ò –ö–ê–¢–ï–ì–û–†–ò–Ø:')) {
            const nextLineIndex = lines.indexOf(line) + 1;
            if (nextLineIndex < lines.length) {
              const nextLine = lines[nextLineIndex];
              if (nextLine && nextLine.startsWith('- ')) {
                return nextLine.substring(2).trim();
              }
            }
          }
        }
        for (let line of lines) {
          if (line.length > 10 && line.length < 100 && !line.includes(':')) {
            return line.trim();
          }
        }
        return '–¢–æ–≤–∞—Ä –¥–ª—è –ø—Ä–æ–¥–∞–∂–∏';
      };

      const detectCategory = (description) => {
        const categoryKeywords = {
          '–û–¥–µ–∂–¥–∞ –∏ –ª–∏—á–Ω—ã–µ –≤–µ—â–∏': ['–∫—Ä–æ—Å—Å–æ–≤–∫–∏', '–æ–±—É–≤—å', '–æ–¥–µ–∂–¥–∞', '—Ñ—É—Ç–±–æ–ª–∫–∞', '–¥–∂–∏–Ω—Å—ã', '–ø–ª–∞—Ç—å–µ', '—Ä—É–±–∞—à–∫–∞', '–±—Ä—é–∫–∏', '—é–±–∫–∞', '–∫—É—Ä—Ç–∫–∞'],
          '–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞ –∏ –±—ã—Ç–æ–≤–∞—è —Ç–µ—Ö–Ω–∏–∫–∞': ['–Ω–æ—É—Ç–±—É–∫', '—Ç–µ–ª–µ—Ñ–æ–Ω', '–∫–æ–º–ø—å—é—Ç–µ—Ä', '—Ç–µ–ª–µ–≤–∏–∑–æ—Ä', '—Ç–µ—Ö–Ω–∏–∫–∞', '–ø–ª–∞–Ω—à–µ—Ç', '–Ω–∞—É—à–Ω–∏–∫–∏'],
          '–¢–µ–ª–µ—Ñ–æ–Ω—ã –∏ —Å–≤—è–∑—å': ['—Ç–µ–ª–µ—Ñ–æ–Ω', '—Å–º–∞—Ä—Ç—Ñ–æ–Ω', '–∞–π—Ñ–æ–Ω', 'samsung', 'xiaomi', 'huawei', '–º–æ–±–∏–ª—å–Ω—ã–π'],
          '–ö–æ–º–ø—å—é—Ç–µ—Ä—ã –∏ –æ—Ä–≥—Ç–µ—Ö–Ω–∏–∫–∞': ['–Ω–æ—É—Ç–±—É–∫', '–∫–æ–º–ø—å—é—Ç–µ—Ä', '–º–æ–Ω–∏—Ç–æ—Ä', '–∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞', '–º—ã—à—å', '–ø—Ä–∏–Ω—Ç–µ—Ä'],
          '–î–µ—Ç—Å–∫–∏–π –º–∏—Ä': ['–¥–µ—Ç—Å–∫', '–∞–≤—Ç–æ–∫—Ä–µ—Å–ª–æ', '–∫–æ–ª—è—Å–∫–∞', '–∏–≥—Ä—É—à–∫–∞', '–ø–∞–º–ø–µ—Ä—Å', '—Å–æ—Å–∫–∞', '–¥–µ—Ç—Å–∫–∞—è –æ–¥–µ–∂–¥–∞'],
          '–í—Å–µ –¥–ª—è –¥–æ–º–∞': ['–º–µ–±–µ–ª—å', '—Å—Ç–æ–ª', '—Å—Ç—É–ª', '–¥–∏–≤–∞–Ω', '–∫—Ä–æ–≤–∞—Ç—å', '—à–∫–∞—Ñ', '–ø–æ—Å—É–¥–∞', '–∫–∞—Å—Ç—Ä—é–ª—è'],
          '–ñ–∏–≤–æ—Ç–Ω—ã–µ –∏ —Ä–∞—Å—Ç–µ–Ω–∏—è': ['—Å–æ–±–∞–∫–∞', '–∫–æ—à–∫–∞', '—â–µ–Ω–æ–∫', '–∫–æ—Ç–µ–Ω–æ–∫', '–∫–æ—Ä–º', '—Ä–∞—Å—Ç–µ–Ω–∏–µ', '—Ü–≤–µ—Ç–æ–∫'],
          '–•–æ–±–±–∏, –º—É–∑—ã–∫–∞ –∏ —Å–ø–æ—Ä—Ç': ['–≥–∏—Ç–∞—Ä–∞', '–ø–∏–∞–Ω–∏–Ω–æ', '—Å–ø–æ—Ä—Ç', '–≤–µ–ª–æ—Å–∏–ø–µ–¥', '–∫–Ω–∏–≥–∞', '—Ñ—É—Ç–±–æ–ª', '—Ç–µ–Ω–Ω–∏—Å']
        };

        const lowerDesc = description.toLowerCase();

        // –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º
        for (let [category, keywords] of Object.entries(categoryKeywords)) {
          if (keywords.some(keyword => lowerDesc.includes(keyword))) {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —ç—Ç–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏—è –≤ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏—è—Ö
            if (categories[category]) {
              return category;
            }
          }
        }

        // –ï—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –ø–µ—Ä–≤—É—é –¥–æ—Å—Ç—É–ø–Ω—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é
        const availableCategories = Object.keys(categories);
        return availableCategories.length > 0 ? availableCategories[0] : '–í—Å–µ –¥–ª—è –¥–æ–º–∞';
      };

      const detectSubCategory = (description, mainCategory) => {
        const lowerDesc = description.toLowerCase();

        // –ï—Å–ª–∏ –æ—Å–Ω–æ–≤–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞, –∏—â–µ–º –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—é –≤ –Ω–µ–π
        if (mainCategory && categories[mainCategory]) {
          const subcategories = categories[mainCategory];

          // –ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –¥–ª—è –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–π
          const subcategoryKeywords = {
            '–ú–æ–±–∏–ª—å–Ω—ã–µ —Ç–µ–ª–µ—Ñ–æ–Ω—ã': ['—Ç–µ–ª–µ—Ñ–æ–Ω', '—Å–º–∞—Ä—Ç—Ñ–æ–Ω', '–∞–π—Ñ–æ–Ω', 'samsung', 'xiaomi'],
            '–ê–∫—Å–µ—Å—Å—É–∞—Ä—ã –¥–ª—è —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤': ['—á–µ—Ö–æ–ª', '–∑–∞—â–∏—Ç–Ω–æ–µ —Å—Ç–µ–∫–ª–æ', '–∑–∞—Ä—è–¥–∫–∞', '–Ω–∞—É—à–Ω–∏–∫–∏'],
            '–ù–æ—É—Ç–±—É–∫–∏': ['–Ω–æ—É—Ç–±—É–∫', '–ª—ç–ø—Ç–æ–ø'],
            '–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –∫–æ–º–ø—å—é—Ç–µ—Ä—ã': ['–∫–æ–º–ø—å—é—Ç–µ—Ä', '—Å–∏—Å—Ç–µ–º–Ω—ã–π –±–ª–æ–∫', '–ø–∫'],
            '–ú—É–∂—Å–∫–∞—è –æ–¥–µ–∂–¥–∞': ['–º—É–∂—Å–∫', '—Ä—É–±–∞—à–∫–∞', '–±—Ä—é–∫–∏', '–∫–æ—Å—Ç—é–º'],
            '–ñ–µ–Ω—Å–∫–∞—è –æ–¥–µ–∂–¥–∞': ['–∂–µ–Ω—Å–∫', '–ø–ª–∞—Ç—å–µ', '—é–±–∫–∞', '–±–ª—É–∑–∫–∞'],
            '–û–±—É–≤—å': ['–∫—Ä–æ—Å—Å–æ–≤–∫–∏', '–±–æ—Ç–∏–Ω–∫–∏', '—Ç—É—Ñ–ª–∏', '—Å–∞–ø–æ–≥–∏', '–æ–±—É–≤—å'],
            '–î–µ—Ç—Å–∫–∞—è –æ–¥–µ–∂–¥–∞': ['–¥–µ—Ç—Å–∫', '–¥–µ—Ç—Å–∫–∞—è –æ–¥–µ–∂–¥–∞'],
            '–ò–≥—Ä—É—à–∫–∏': ['–∏–≥—Ä—É—à–∫–∞', '–∫—É–∫–ª–∞', '–º–∞—à–∏–Ω–∫–∞', '–∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä'],
            '–ú–µ–±–µ–ª—å': ['—Å—Ç–æ–ª', '—Å—Ç—É–ª', '–¥–∏–≤–∞–Ω', '–∫—Ä–æ–≤–∞—Ç—å', '—à–∫–∞—Ñ']
          };

          // –ò—â–µ–º –ø–æ–¥—Ö–æ–¥—è—â—É—é –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—é
          for (let subcategory of subcategories) {
            if (subcategoryKeywords[subcategory]) {
              const keywords = subcategoryKeywords[subcategory];
              if (keywords.some(keyword => lowerDesc.includes(keyword))) {
                return subcategory;
              }
            }
          }

          // –ï—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –ø–µ—Ä–≤—É—é –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—é
          return subcategories.length > 0 ? subcategories[0] : '';
        }

        return '';
      };

      const extractPrice = (description) => {
        const priceMatch = description.match(/(\d+)\s*(—Å–æ–º–æ–Ω–∏|–¥–æ–ª–ª–∞—Ä|—Ä—É–±–ª)/i);
        if (priceMatch) {
          return priceMatch[1];
        }
        return '0';
      };

      const extractBrand = (description) => {
        const brands = ['Nike', 'Adidas', 'Samsung', 'Apple', 'HP', 'Dell', 'Sony', 'LG', 'MAXI-COSI', 'IKEA', 'Zara', 'H&M'];
        const lowerDesc = description.toLowerCase();
        for (let brand of brands) {
          if (lowerDesc.includes(brand.toLowerCase())) {
            return brand;
          }
        }
        return '';
      };

      const extractCondition = (description) => {
        const lowerDesc = description.toLowerCase();
        if (lowerDesc.includes('–Ω–æ–≤—ã–π') || lowerDesc.includes('–Ω–æ–≤–æ–µ')) return '–ù–æ–≤–æ–µ';
        if (lowerDesc.includes('–æ—Ç–ª–∏—á–Ω–æ–µ') || lowerDesc.includes('–æ—Ç–ª–∏—á–Ω–æ')) return '–û—Ç–ª–∏—á–Ω–æ–µ';
        if (lowerDesc.includes('—Ö–æ—Ä–æ—à–µ–µ') || lowerDesc.includes('—Ö–æ—Ä–æ—à–æ')) return '–•–æ—Ä–æ—à–µ–µ';
        if (lowerDesc.includes('—É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ–µ')) return '–£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ–µ';
        return '–•–æ—Ä–æ—à–µ–µ';
      };

      const updateResult = (id, field, value) => {
        setResults(prev => prev.map(item =>
          item.id === id ? { ...item, [field]: value } : item
        ));
      };

      const deleteResult = (id) => {
        setResults(prev => prev.filter(item => item.id !== id));
      };

      const publishItem = (item) => {
        setPublishedItems(prev => [...prev, { ...item, promotionType: 'standard', days: 0 }]);
      };

      const publishAllItems = () => {
        const itemsToPublish = results.map(item => ({ ...item, promotionType: 'standard', days: 0 }));
        setPublishedItems(itemsToPublish);
        setCurrentStep('promotion');
      };

      const updatePromotion = (id, promotionType, days) => {
        setPublishedItems(prev => prev.map(item =>
          item.id === id ? { ...item, promotionType, days } : item
        ));
      };

      const getPromotionStats = () => {
        const stats = {
          standard: publishedItems.filter(item => item.promotionType === 'standard').length,
          top: publishedItems.filter(item => item.promotionType === 'top').length,
          vip: publishedItems.filter(item => item.promotionType === 'vip').length,
          total: 0
        };

        stats.total = publishedItems.reduce((sum, item) => {
          if (item.promotionType === 'top') return sum + (5 * item.days);
          if (item.promotionType === 'vip') return sum + (10 * item.days);
          return sum;
        }, 0);

        return stats;
      };

      // –õ–æ–≥–æ—Ç–∏–ø Somon.tj
      const SomonLogo = () => (
        <div className="flex items-center">
          <span className="text-somon-blue font-bold text-xl">So</span>
          <span className="text-somon-orange font-bold text-xl">mon</span>
          <span className="text-somon-green font-bold text-xl">.tj</span>
        </div>
      );

      if (currentStep === 'upload') {
        return (
          <div className="min-h-screen bg-gray-50 mobile-container">
            {/* Header */}
            <div className="bg-white border-b border-gray-200 p-4">
              <div className="flex items-center justify-between">
                <SomonLogo />
                <div className="md:hidden">
                  <svg className="w-6 h-6 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 6h16M4 12h16M4 18h16" />
                  </svg>
                </div>
              </div>
            </div>

            <div className="p-4 md:p-6 lg:p-8">
              {/* Hero Section */}
              <div className="text-center mb-8">
                <div className="inline-flex items-center justify-center w-16 h-16 md:w-20 md:h-20 bg-somon-orange rounded-full mb-4">
                  <svg className="w-8 h-8 md:w-10 md:h-10 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z" />
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 13a3 3 0 11-6 0 3 3 0 016 0z" />
                  </svg>
                </div>
                <h1 className="text-2xl md:text-3xl lg:text-4xl font-bold text-gray-800 mb-2">
                  –ü–æ–¥–∞—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ
                </h1>
                <p className="text-gray-600 text-sm md:text-base max-w-md mx-auto">
                  –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–æ—Ç–æ —Ç–æ–≤–∞—Ä–æ–≤ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—ä—è–≤–ª–µ–Ω–∏–π —Å –ø–æ–º–æ—â—å—é –ò–ò
                </p>
              </div>

              {/* Upload Area */}
              <div className="bg-white rounded-lg border p-4 md:p-6 mb-6">
                <div
                  className={`relative border-2 border-dashed rounded-lg p-6 md:p-8 transition-all ${dragActive ? 'drag-active' : 'border-gray-300'
                    }`}
                  onDragEnter={handleDrag}
                  onDragLeave={handleDrag}
                  onDragOver={handleDrag}
                  onDrop={handleDrop}
                >
                  <input
                    ref={fileInputRef}
                    type="file"
                    multiple
                    accept="image/*"
                    onChange={handleFileSelect}
                    className="hidden"
                  />

                  <div className="text-center">
                    <svg className="w-10 h-10 md:w-12 md:h-12 text-gray-400 mx-auto mb-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
                    </svg>
                    <h3 className="text-base md:text-lg font-medium text-gray-700 mb-2">
                      –î–æ–±–∞–≤—å—Ç–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤
                    </h3>
                    <p className="text-gray-500 text-sm mb-4">
                      –ù–∞–∂–º–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞ –∏–ª–∏ –ø–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Å—é–¥–∞
                    </p>
                    <button
                      onClick={() => fileInputRef.current?.click()}
                      className="bg-somon-orange text-white px-6 py-2 md:px-8 md:py-3 rounded-lg text-sm md:text-base font-medium hover:bg-orange-600 transition-colors"
                    >
                      –í—ã–±—Ä–∞—Ç—å —Ñ–æ—Ç–æ
                    </button>
                  </div>
                </div>

                {uploadedImages.length > 0 && (
                  <div className="mt-6">
                    <div className="flex items-center justify-between mb-3">
                      <h3 className="text-sm md:text-base font-medium text-gray-700">
                        –ó–∞–≥—Ä—É–∂–µ–Ω–æ: {uploadedImages.length} —Ñ–æ—Ç–æ
                      </h3>
                    </div>
                    <div className="grid grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-2 md:gap-3">
                      {uploadedImages.map((image) => (
                        <div key={image.id} className="relative">
                          <img
                            src={image.preview}
                            alt={image.name}
                            className="w-full h-20 md:h-24 object-cover rounded border"
                          />
                          <button
                            onClick={() => removeImage(image.id)}
                            className="absolute -top-1 -right-1 bg-red-500 text-white rounded-full w-5 h-5 md:w-6 md:h-6 flex items-center justify-center text-xs hover:bg-red-600"
                          >
                            √ó
                          </button>
                        </div>
                      ))}
                    </div>
                  </div>
                )}

                {uploadedImages.length > 0 && (
                  <div className="mt-6">
                    <h3 className="text-sm md:text-base font-medium text-gray-700 mb-2">
                      –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–æ–≤–∞—Ä–∞—Ö (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
                    </h3>
                    <textarea
                      value={userDescription}
                      onChange={(e) => setUserDescription(e.target.value)}
                      placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä:
1. –ö—Ä–æ—Å—Å–æ–≤–∫–∏ Nike, —Ä–∞–∑–º–µ—Ä 42, –Ω–æ–≤—ã–µ, —Ü–µ–Ω–∞ 500 —Å–æ–º–æ–Ω–∏
2. –°—Ç–∏—Ä–∞–ª—å–Ω–∞—è –º–∞—à–∏–Ω–∞ LG, 5–∫–≥, –æ—Ç–ª–∏—á–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, 800 —Å–æ–º–æ–Ω–∏  
3. –î–µ—Ç—Å–∫–æ–µ –∞–≤—Ç–æ–∫—Ä–µ—Å–ª–æ, –∫—Ä–∞—Å–Ω–æ–µ, —Ö–æ—Ä–æ—à–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, 300 —Å–æ–º–æ–Ω–∏

–£–∫–∞–∂–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏—è, —Ä–∞–∑–º–µ—Ä—ã, —Ü–µ–Ω—ã, —Å–æ—Å—Ç–æ—è–Ω–∏–µ - —ç—Ç–æ –ø–æ–º–æ–∂–µ—Ç –ò–ò —Å–æ–∑–¥–∞—Ç—å –±–æ–ª–µ–µ —Ç–æ—á–Ω—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è."
                      rows={6}
                      className="w-full p-3 border border-gray-300 rounded-lg text-sm placeholder-gray-400 focus:ring-1 focus:ring-somon-orange focus:border-somon-orange"
                    />
                    <p className="text-xs text-gray-500 mt-1">
                      –ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ ‚Ä¢ –ü–æ–º–æ–∂–µ—Ç –ò–ò —Å–æ–∑–¥–∞—Ç—å –±–æ–ª–µ–µ —Ç–æ—á–Ω—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è
                    </p>
                  </div>
                )}

                {uploadedImages.length > 0 && (
                  <div className="mt-6">
                    <button
                      onClick={processImages}
                      disabled={processing}
                      className="w-full bg-somon-orange text-white py-3 md:py-4 rounded-lg font-medium disabled:opacity-50 disabled:cursor-not-allowed hover:bg-orange-600 transition-colors"
                    >
                      {processing ? (
                        <div className="flex items-center justify-center">
                          <div className="spinner mr-2"></div>
                          –ò–ò –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ç–æ–≤–∞—Ä—ã...
                        </div>
                      ) : (
                        `–ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å ${uploadedImages.length} —Ç–æ–≤–∞—Ä–æ–≤ —Å –ò–ò`
                      )}
                    </button>
                  </div>
                )}
              </div>

              {/* Features */}
              <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div className="bg-white rounded-lg border p-4 flex items-center">
                  <div className="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center mr-3">
                    <svg className="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 10V3L4 14h7v7l9-11h-7z" />
                    </svg>
                  </div>
                  <div>
                    <h3 className="font-medium text-gray-800 text-sm">–ò–ò —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ</h3>
                    <p className="text-gray-600 text-xs">–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–æ–≤–∞—Ä—ã</p>
                  </div>
                </div>

                <div className="bg-white rounded-lg border p-4 flex items-center">
                  <div className="w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center mr-3">
                    <svg className="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                    </svg>
                  </div>
                  <div>
                    <h3 className="font-medium text-gray-800 text-sm">–£–º–Ω—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è</h3>
                    <p className="text-gray-600 text-xs">–°–æ–∑–¥–∞–µ—Ç –æ–ø–∏—Å–∞–Ω–∏—è –¥–ª—è –ø—Ä–æ–¥–∞–∂–∏</p>
                  </div>
                </div>

                <div className="bg-white rounded-lg border p-4 flex items-center">
                  <div className="w-8 h-8 bg-orange-100 rounded-lg flex items-center justify-center mr-3">
                    <svg className="w-5 h-5 text-orange-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                  </div>
                  <div>
                    <h3 className="font-medium text-gray-800 text-sm">–ë—ã—Å—Ç—Ä—ã–π –∞–Ω–∞–ª–∏–∑</h3>
                    <p className="text-gray-600 text-xs">–ú–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–π</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        );
      }

      if (currentStep === 'promotion') {
        const stats = getPromotionStats();

        return (
          <div className="min-h-screen bg-gray-50 mobile-container">
            <div className="bg-white border-b border-gray-200 p-4">
              <div className="flex items-center">
                <button onClick={() => setCurrentStep('results')} className="mr-3">
                  <svg className="w-6 h-6 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 19l-7-7 7-7" />
                  </svg>
                </button>
                <div className="flex-1">
                  <h1 className="text-lg font-bold text-gray-800">–ü—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ</h1>
                </div>
              </div>
            </div>

            <div className="p-4 md:p-6">
              <div className="bg-white rounded-lg border p-4 md:p-6 mb-6">
                <h2 className="text-base md:text-lg font-medium text-gray-800 mb-3">–ü—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–π</h2>
                <p className="text-sm text-gray-600 mb-4">
                  –£–≤–µ–ª–∏—á—å—Ç–µ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã —Å –ø–æ–º–æ—â—å—é –¢–û–ü –∏ –í–ò–ü —Ä–∞–∑–º–µ—â–µ–Ω–∏—è
                </p>
              </div>

              <div className="space-y-4 mb-6">
                {publishedItems.map((item) => (
                  <PromotionCard key={item.id} item={item} onUpdate={updatePromotion} />
                ))}
              </div>

              <div className="bg-white rounded-lg border p-4 md:p-6 mb-6">
                <h3 className="font-medium text-gray-800 mb-3">–ò—Ç–æ–≥–æ</h3>
                <div className="space-y-2">
                  <div className="flex justify-between text-sm">
                    <span className="text-gray-600">–û–±—ã—á–Ω—ã—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏–π:</span>
                    <span className="font-medium">{stats.standard}</span>
                  </div>
                  <div className="flex justify-between text-sm">
                    <span className="text-gray-600">–¢–û–ü –æ–±—ä—è–≤–ª–µ–Ω–∏–π:</span>
                    <span className="font-medium text-yellow-600">{stats.top}</span>
                  </div>
                  <div className="flex justify-between text-sm">
                    <span className="text-gray-600">–í–ò–ü –æ–±—ä—è–≤–ª–µ–Ω–∏–π:</span>
                    <span className="font-medium text-purple-600">{stats.vip}</span>
                  </div>
                  <div className="border-t pt-2">
                    <div className="flex justify-between">
                      <span className="font-medium text-gray-800">–û–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å —Ä–∞–∑–º–µ—â–µ–Ω–∏—è:</span>
                      <span className="font-bold text-somon-orange">{stats.total} —Å–æ–º–æ–Ω–∏</span>
                    </div>
                  </div>
                </div>
              </div>

              <button
                onClick={() => alert('–û–±—ä—è–≤–ª–µ–Ω–∏—è –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω—ã –Ω–∞ Somon.tj!')}
                className="w-full bg-somon-orange text-white py-3 md:py-4 rounded-lg font-medium hover:bg-orange-600 transition-colors"
              >
                –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –∑–∞ {stats.total} —Å–æ–º–æ–Ω–∏
              </button>
            </div>
          </div>
        );
      }

      return (
        <div className="min-h-screen bg-gray-50 mobile-container">
          <div className="bg-white border-b border-gray-200 p-4">
            <div className="flex items-center">
              <button onClick={() => setCurrentStep('upload')} className="mr-3">
                <svg className="w-6 h-6 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 19l-7-7 7-7" />
                </svg>
              </button>
              <div className="flex-1">
                <h1 className="text-lg font-bold text-gray-800">–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è</h1>
                <p className="text-xs text-gray-600">–ò–ò –Ω–∞—à–µ–ª {results.length} —Ç–æ–≤–∞—Ä–æ–≤</p>
              </div>
            </div>
          </div>

          <div className="p-4 md:p-6">
            <div className="space-y-4 mb-6">
              {results.map((item) => (
                <ResultCard
                  key={item.id}
                  item={item}
                  categories={categories}
                  conditions={conditions}
                  currencies={currencies}
                  onUpdate={updateResult}
                  onDelete={deleteResult}
                  onPublish={publishItem}
                />
              ))}
            </div>

            {results.length > 0 && (
              <button
                onClick={publishAllItems}
                className="w-full bg-somon-orange text-white py-3 md:py-4 rounded-lg font-medium hover:bg-orange-600 transition-colors"
              >
                –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –≤—Å–µ ({results.length})
              </button>
            )}
          </div>
        </div>
      );
    };

    // –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –∫–∞—Ä—Ç–æ—á–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
    const ResultCard = ({ item, categories, conditions, currencies, onUpdate, onDelete, onPublish }) => {
      const [formData, setFormData] = useState(item);
      const [isExpanded, setIsExpanded] = useState(false);

      const handleChange = (field, value) => {
        const newData = { ...formData, [field]: value };
        setFormData(newData);
        onUpdate(item.id, field, value);
      };

      const handleMainCategoryChange = (mainCategory) => {
        handleChange('mainCategory', mainCategory);
        if (categories[mainCategory] && categories[mainCategory].length > 0) {
          handleChange('subCategory', categories[mainCategory][0]);
        }
      };

      return (
        <div className="bg-white rounded-lg border product-card">
          <div className="p-4">
            <div className="flex">
              <img
                src={item.images[0]}
                alt={formData.title}
                className="w-16 h-16 md:w-20 md:h-20 object-cover rounded mr-3 flex-shrink-0"
              />
              <div className="flex-1 min-w-0">
                <input
                  type="text"
                  value={formData.title}
                  onChange={(e) => handleChange('title', e.target.value)}
                  className="w-full font-medium text-gray-800 border-none p-0 text-sm md:text-base bg-transparent focus:outline-none"
                  placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞"
                />
                <div className="flex items-center mt-1">
                  <input
                    type="number"
                    value={formData.price}
                    onChange={(e) => handleChange('price', e.target.value)}
                    className="w-16 md:w-20 text-somon-orange font-bold text-sm md:text-base border-none p-0 bg-transparent focus:outline-none"
                    placeholder="0"
                  />
                  <span className="text-somon-orange font-bold text-sm md:text-base ml-1">{formData.currency}</span>
                </div>
                <div className="flex items-center justify-between mt-1">
                  <span className="bg-orange-100 text-orange-800 px-2 py-0.5 rounded text-xs">
                    {formData.mainCategory}
                  </span>
                </div>
              </div>
              <button
                onClick={() => setIsExpanded(!isExpanded)}
                className="text-gray-400 p-1 hover:text-gray-600"
              >
                {isExpanded ? (
                  <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
                  </svg>
                ) : (
                  <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
                  </svg>
                )}
              </button>
            </div>
          </div>

          {isExpanded && (
            <div className="px-4 pb-4 border-t border-gray-100 pt-4 space-y-3">
              <div>
                <label className="block text-xs text-gray-600 mb-1">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                <select
                  value={formData.mainCategory}
                  onChange={(e) => handleMainCategoryChange(e.target.value)}
                  className="w-full p-2 border border-gray-300 rounded text-sm focus:ring-1 focus:ring-somon-orange"
                >
                  {Object.keys(categories).map(cat => (
                    <option key={cat} value={cat}>{cat}</option>
                  ))}
                </select>
              </div>

              <div>
                <label className="block text-xs text-gray-600 mb-1">–ü–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                <select
                  value={formData.subCategory}
                  onChange={(e) => handleChange('subCategory', e.target.value)}
                  className="w-full p-2 border border-gray-300 rounded text-sm focus:ring-1 focus:ring-somon-orange"
                >
                  {categories[formData.mainCategory]?.map(subcat => (
                    <option key={subcat} value={subcat}>{subcat}</option>
                  ))}
                </select>
              </div>

              <div>
                <label className="block text-xs text-gray-600 mb-1">–û–ø–∏—Å–∞–Ω–∏–µ –æ—Ç –ò–ò</label>
                <textarea
                  value={formData.description}
                  onChange={(e) => handleChange('description', e.target.value)}
                  rows={8}
                  className="w-full p-2 border border-gray-300 rounded text-sm focus:ring-1 focus:ring-somon-orange"
                  placeholder="–û–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞"
                />
              </div>

              <div className="grid grid-cols-2 gap-3">
                <div>
                  <label className="block text-xs text-gray-600 mb-1">–ë—Ä–µ–Ω–¥</label>
                  <input
                    type="text"
                    value={formData.brand}
                    onChange={(e) => handleChange('brand', e.target.value)}
                    className="w-full p-2 border border-gray-300 rounded text-sm focus:ring-1 focus:ring-somon-orange"
                    placeholder="–ë—Ä–µ–Ω–¥"
                  />
                </div>

                <div>
                  <label className="block text-xs text-gray-600 mb-1">–°–æ—Å—Ç–æ—è–Ω–∏–µ</label>
                  <select
                    value={formData.condition}
                    onChange={(e) => handleChange('condition', e.target.value)}
                    className="w-full p-2 border border-gray-300 rounded text-sm focus:ring-1 focus:ring-somon-orange"
                  >
                    {conditions.map(cond => (
                      <option key={cond} value={cond}>{cond}</option>
                    ))}
                  </select>
                </div>
              </div>

              <div>
                <label className="block text-xs text-gray-600 mb-1">–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ</label>
                <input
                  type="text"
                  value={formData.location}
                  onChange={(e) => handleChange('location', e.target.value)}
                  className="w-full p-2 border border-gray-300 rounded text-sm focus:ring-1 focus:ring-somon-orange"
                  placeholder="–ì–æ—Ä–æ–¥"
                />
              </div>

              <div className="flex space-x-2 pt-2">
                <button
                  onClick={() => onDelete(item.id)}
                  className="flex-1 bg-red-50 text-red-600 py-2 rounded text-sm font-medium hover:bg-red-100 transition-colors"
                >
                  –£–¥–∞–ª–∏—Ç—å
                </button>
                <button
                  onClick={() => onPublish(formData)}
                  className="flex-1 bg-somon-orange text-white py-2 rounded text-sm font-medium hover:bg-orange-600 transition-colors"
                >
                  –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å
                </button>
              </div>
            </div>
          )}
        </div>
      );
    };

    const PromotionCard = ({ item, onUpdate }) => {
      const [promotionType, setPromotionType] = useState('standard');
      const [days, setDays] = useState(3);

      const handlePromotionChange = (type, dayCount) => {
        setPromotionType(type);
        setDays(dayCount);
        onUpdate(item.id, type, dayCount);
      };

      const promotionOptions = [
        { type: 'standard', name: '–û–±—ã—á–Ω–æ–µ', price: 0, icon: 'üëÅÔ∏è', desc: '–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ' },
        { type: 'top', name: '–¢–û–ü', price: 5, icon: '‚≠ê', desc: '–ü–æ–∫–∞–∑ –≤ —Ç–æ–ø–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏' },
        { type: 'vip', name: '–í–ò–ü', price: 10, icon: 'üëë', desc: '–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–π –ø–æ–∫–∞–∑' }
      ];

      return (
        <div className="bg-white rounded-lg border p-4">
          <div className="flex mb-4">
            <img src={item.images[0]} alt={item.title} className="w-12 h-12 md:w-16 md:h-16 object-cover rounded mr-3" />
            <div className="flex-1">
              <h3 className="font-medium text-gray-800 text-sm md:text-base">{item.title}</h3>
              <p className="text-xs md:text-sm text-gray-600">{item.price} {item.currency}</p>
            </div>
          </div>

          <div className="space-y-3">
            {promotionOptions.map((option) => (
              <label key={option.type} className="flex items-center p-3 border rounded-lg cursor-pointer hover:bg-gray-50">
                <input
                  type="radio"
                  name={`promotion-${item.id}`}
                  value={option.type}
                  checked={promotionType === option.type}
                  onChange={() => handlePromotionChange(option.type, days)}
                  className="mr-3"
                />
                <div className="flex-1">
                  <div className="flex items-center">
                    <span className="text-lg mr-2">{option.icon}</span>
                    <span className="font-medium text-sm">{option.name}</span>
                    {option.price > 0 && (
                      <span className="ml-auto text-somon-orange font-bold text-sm">
                        {option.price} —Å–æ–º–æ–Ω–∏/–¥–µ–Ω—å
                      </span>
                    )}
                  </div>
                  <p className="text-xs text-gray-500 mt-1">{option.desc}</p>
                </div>
              </label>
            ))}
          </div>

          {(promotionType === 'top' || promotionType === 'vip') && (
            <div className="mt-4">
              <label className="block text-xs text-gray-600 mb-2">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π</label>
              <select
                value={days}
                onChange={(e) => handlePromotionChange(promotionType, parseInt(e.target.value))}
                className="w-full p-2 border border-gray-300 rounded text-sm focus:ring-1 focus:ring-somon-orange"
              >
                {[1, 3, 7, 14, 30].map(day => (
                  <option key={day} value={day}>{day} –¥–Ω–µ–π</option>
                ))}
              </select>
            </div>
          )}
        </div>
      );
    };

    // –†–µ–Ω–¥–µ—Ä–∏–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<PhotoListingApp />);
  </script>
</body>

</html>